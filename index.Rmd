---
title: "ETC5521 Assignment 1"
subtitle: "How sustainable is the energy production in Europe? "
team: Koala
author:
  - Patu Saputra 
  - Vinny Vu
date: "`r Sys.Date()`"
output: 
  html_document
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r loading-packages, include=FALSE}
library(tidytuesdayR)
library(tidyverse)
library(kableExtra)
```

# Introduction and motivation

[FILL] Give the bigger picture of the data, and inspire the reader to learn more about the problem by reading your analysis. 

In today's day and age there has been a strong push for the reduction in production and use of fossil fuels. Per Peninsula Energy fossil fuels "produce a significant amount of greenhouse gas emissions, including carbon dioxide methane," (Peninsula Clean Energy, 2018.) These greenhouse gas emissions are known to be a main contributor to the ‘greenhouse effect’ “the warming of climate that results when the atmosphere traps heat radiating from Earth towards space,” (NASA, 2007.) Not only does thermal power produced by fossil fuels emit green house gases, it is not renewable, meaning it cannot be “replaced naturally in a short period of time” resulting in long-term price volatility and unsustainability.

As a result, the European power sector currently plays a crucial role in attaining targets to “cut green-house gases by 40% by 2030, compared to 1990” (European Power sector, 2017) in favor cleaner, renewable energy sources. For the purposes of this analysis we will be using Eurostat European Energy data (Eurostat, 2020) assess how successful they currently are and answer the question:  


How sustainable is the energy production in Europe? 

Specifically:

* Which countries have the highest production of sustainable energy?
* What is the trend in energy usage in Europe?  
* What is the trend in sustainable vs unsustainable energy production?



# Data description


# Analysis and findings

```{r, include=FALSE}
#loading European Energy data
tuesdata <- tidytuesdayR::tt_load(2020, week = 32)
```

```{r}
#Obtaining energy types and country totals data sets 
energy_types <- tuesdata$energy_types
country_totals <- tuesdata$country_totals
```




```{r}
head(energy_types) %>%
  kable(caption = "Energy Types") %>%
  kable_styling(bootstrap_options = "striped",
                latex_options = "hold_position")

head(country_totals) %>%
  kable(caption = "Energy Types") %>%
  kable_styling(bootstrap_options = "striped",
                latex_options = "hold_position")
```

```{r}
energy_types %>%
  pivot_longer(cols = c("2016","2017","2018"),
               names_to = "Year",
               values_to = "Production") %>%
  mutate(Year = as.numeric(Year)) %>%
  filter(country_name == "Belgium") %>% 
  ggplot(aes(x = Year,
             y = Production,
             fill = type)) +
  geom_col() +
  ggtitle("Belgium Energy Types")
```



```{r}
country_totals %>%
  pivot_longer(cols = c("2016","2017","2018"),
               names_to = "Year",
               values_to = "Production") %>%
  mutate(Year = as.numeric(Year)) %>%
  filter(country_name == "Belgium") %>%
  ggplot(aes(x = Year,
             y = Production,
             fill = type)) +
  geom_col() +  
  ggtitle("Belgium Energy Totals")
```
## Which countries have the highest production of sustainable energy?


## What is the trend in energy usage in Europe?  


## What is the trend in sustainable vs unsustainable energy production?
```{r}
eng_2018 <- energy_types %>%
  select(-"2017", -"2016") %>%
  rename(energy = "2018") %>%
  filter(type != "Pumped hydro power") %>%
  pivot_wider(id_cols = c(country, country_name, level),
              names_from = type,
              values_from = energy) %>%
  mutate(total = `Conventional thermal` +Nuclear + Hydro + Wind + Solar + Geothermal + Other) %>%
  mutate(`Conventional thermal` = -`Conventional thermal`) %>%
  pivot_longer(cols = -c(country,country_name,level,total),
               names_to = "name",
               values_to = "value") %>%
  mutate(proportion = value/total)
              
eng_2018 %>%
  arrange(-total)
```

```{r}
eng_2017 <- energy_types %>%
  select(-"2018", -"2016") %>%
  rename(energy = "2017") %>%
  filter(type != "Pumped hydro power") %>%
  pivot_wider(id_cols = c(country, country_name, level),
              names_from = type,
              values_from = energy) %>%
  mutate(total = `Conventional thermal` +Nuclear + Hydro + Wind + Solar + Geothermal + Other) %>%
  mutate(`Conventional thermal` = -`Conventional thermal`) %>%
  pivot_longer(cols = -c(country,country_name,level,total),
               names_to = "name",
               values_to = "value") %>%
  mutate(proportion = value/total)
```

```{r}
eng_2016 <- energy_types %>%
  select(-"2018", -"2017") %>%
  rename(energy = "2016") %>%
  filter(type != "Pumped hydro power") %>%
  pivot_wider(id_cols = c(country, country_name, level),
              names_from = type,
              values_from = energy) %>%
  mutate(total = `Conventional thermal` +Nuclear + Hydro + Wind + Solar + Geothermal + Other) %>%
  mutate(`Conventional thermal` = -`Conventional thermal`) %>%
  pivot_longer(cols = -c(country,country_name,level,total),
               names_to = "name",
               values_to = "value") %>%
  mutate(proportion = value/total)
```

```{r}
eng_2016 %>%
  ggplot(aes(x = reorder(country, -total),
             y = proportion,
             fill = name)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90))
```

```{r}
eng_2017 %>%
  ggplot(aes(x = reorder(country, -total),
             y = proportion,
             fill = name)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90))
```
```{r}
eng_2018
```


```{r}
eng_2018 %>%
  ggplot(aes(x = reorder(country, -total),
             y = proportion,
             fill = name)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90))
```
```{r}
tot_2016 <- energy_types %>%
 select(-"2018", -"2017") %>%
 rename(energy = "2016") %>%
 filter(type != "Pumped hydro power") %>%
 pivot_wider(id_cols = c(country, country_name, level),
             names_from = type,
             values_from = energy) %>%
 summarise(Year = 2016,
           `Conventional thermal` = -sum(`Conventional thermal`),
           Nuclear = sum(Nuclear),
           Hydro = sum(Hydro),
           Wind = sum(Wind),
           Solar = sum(Solar),
           Geothermal = sum(Geothermal),
           Other = sum(Other))

tot_2017 <- energy_types %>%
 select(-"2018", -"2016") %>%
 rename(energy = "2017") %>%
 filter(type != "Pumped hydro power") %>%
 pivot_wider(id_cols = c(country, country_name, level),
             names_from = type,
             values_from = energy) %>%
 summarise(Year = 2017,
           `Conventional thermal` = -sum(`Conventional thermal`),
           Nuclear = sum(Nuclear),
           Hydro = sum(Hydro),
           Wind = sum(Wind),
           Solar = sum(Solar),
           Geothermal = sum(Geothermal),
           Other = sum(Other))


tot_2018 <- energy_types %>%
 select(-"2017", -"2016") %>%
 rename(energy = "2018") %>%
 filter(type != "Pumped hydro power") %>%
 pivot_wider(id_cols = c(country, country_name, level),
             names_from = type,
             values_from = energy) %>%
 summarise(Year = 2018,
           `Conventional thermal` = -sum(`Conventional thermal`),
           Nuclear = sum(Nuclear),
           Hydro = sum(Hydro),
           Wind = sum(Wind),
           Solar = sum(Solar),
           Geothermal = sum(Geothermal),
           Other = sum(Other))


tot <- bind_rows(tot_2016,tot_2017,tot_2018) %>%
  mutate(total = -`Conventional thermal` +Nuclear + Hydro + Wind + Solar + Geothermal + Other) %>%
  pivot_longer(cols = -c(Year,total),
               names_to = "name",
               values_to = "value") %>%
  mutate(proportion = value/total)
tot
```

```{r}
tot 
```


```{r}
tot %>%
  ggplot(aes(x = Year,
             y = proportion,
             fill = name)) +
  geom_col()
```
```{r}
tot %>%
  ggplot(aes(x = Year,
             y = value,
             fill = name)) +
  geom_col()
```



```{r}
eng %>%
  ggplot(aes(x = reorder(country, -total),
             y = proportion,
             fill = name,
             width = total)) +
  geom_col()
```

[FILL] Should include at least one plot or numerical summary for each of your questions, that helps the reader arrive at an answer. You should also write paragraphs describing the methods, summaries and findings. 

# References
https://github.com/etc5521-2020/assignment-1-koala/blob/master/index.Rmd

https://svs.gsfc.nasa.gov/20114#:~:text=The%20'greenhouse%20effect'%20is%20the,radiating%20from%20Earth%20toward%20space.&text=The%20gases%20that%20contribute%20to,%2C%20and%20chlorofluorocarbons%20(CFCs).

https://www.peninsulacleanenergy.com/faq-items/what-is-the-difference-between-clean-and-renewable-energy/

https://ember-climate.org/wp-content/uploads/2018/01/EU-power-sector-report-2017.pdf



