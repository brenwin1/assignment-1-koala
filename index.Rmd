---
title: "ETC5521 Assignment 1"
subtitle: "How sustainable is the energy production in Europe? "
team: Koala
author:
  - Patu Saputra 
  - Vinny Vu
date: "`r Sys.Date()`"
output: 
  html_document
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r loading-packages, include=FALSE}
library(tidytuesdayR)
library(tidyverse)
library(kableExtra)
library(plotly)
```

# Introduction and motivation

[FILL] Give the bigger picture of the data, and inspire the reader to learn more about the problem by reading your analysis. 

In today's day and age there has been a strong push for the reduction in production and use of fossil fuels. Per Peninsula Energy fossil fuels "produce a significant amount of greenhouse gas emissions, including carbon dioxide methane," (Peninsula Clean Energy, 2018.) These greenhouse gas emissions are known to be a main contributor to the ‘greenhouse effect’ “the warming of climate that results when the atmosphere traps heat radiating from Earth towards space,” (NASA, 2007.) Not only does thermal power produced by fossil fuels emit green house gases, it is not renewable, meaning it cannot be “replaced naturally in a short period of time” resulting in long-term price volatility and unsustainability.

Per Our World Data Europe is currently the 3rd highest consumer of primary energy behind Asia pacific and North America making up approximately 15% of the total World Energy Consumption (Our World Data, 2019).  

As a result, the European power sector currently plays a crucial role in attaining targets to “cut green-house gases by 40% by 2030, compared to 1990” (European Power sector, 2017) in favor cleaner, renewable energy sources. For the purposes of this analysis we will be using Eurostat European Energy data (Eurostat, 2020) assess how successful they currently are and answer the question:  


How sustainable is the energy production in Europe? 

Specifically:

1. Which countries have the highest production of sustainable energy based on energy types? 
2. How do energy imports vs exports compare between countries in Europe from 2016-2018?
3. How the contributions of the sources to the production of electricity


# Data description

```{r, include = FALSE}
energy_types <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-08-04/energy_types.csv')
country_totals <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-08-04/country_totals.csv')
energy_types <- energy_types %>%
  replace_na(list(country_name = "United Kingdom")) %>%
    pivot_longer(cols = starts_with("20"),
               names_to = "year",
               values_to = "energy")
energy_types$year <- as.numeric(energy_types$year)
country_totals <- country_totals %>% 
  replace_na(list(country_name = "United Kingdom")) %>%
  pivot_longer(cols = starts_with("20"),
               names_to = "year",
               values_to = "energy")
country_totals$year <- as.numeric(country_totals$year)
```



The data in the tidytuesday package is taken from Eurostat that contains the electricity production of the countries in the European Union.  The data is given in tabular form in two tables, `country_totals` and `energy_types`. The `energy_types` table containing the types of energy produced by each country. The `country_totals` table contains the brake down energy supplied by each country.
The variables in the `energy_types` table are included below:

```{r,include = FALSE}
variables_1 <- energy_types %>% names()
class_1 <- sapply(energy_types, class)
desc_1 <- c("Country ID",
           "Country name",
           "Type of energy production",
           "Level - either total, level 1 or level 2. Where level 2 makes up level 1 that makes up the total",
           "Year of observation",
           "Energy in GWh (Gigawatt hours)")
```

```{r, echo=FALSE}
tibble(variables_1,class_1,desc_1) %>%
  kable(col.names = c("variable","class","description")) %>%
  kable_styling(bootstrap_options = "hover")
```

The variables in the `country_totals` table are included below: 

```{r, include = FALSE}
variables_2 <- country_totals %>% names()
class_2 <- sapply(country_totals, class)
desc_2 <- c("Country ID",
           "Country name",
           "Type of energy production",
           "Level - either total, level 1 or level 2. Where level 2 makes up level 1 that makes up the total",
           "Year of observation",
           "Energy in GWh (Gigawatt hours)")
```

```{r, echo=FALSE}
tibble(variables_2,class_2,desc_2) %>%
  kable(col.names = c("variable","class","description")) %>%
  kable_styling(bootstrap_options = "hover")
```

The data in the tidytuesday package only contains yearly totals from 2016-2018. However, monthly data can be found on the Eurostat website including data from 2010 until May 2020 as at 14-08-20. The statistics are collected and compiled by Member States. Eurostat prepared a template to gather this information.  



# Analysis and findings




##  Which countries have the highest production of sustainable energy based on energy types? 




```{r energy_types_2018_plot,include=FALSE}
energy_types %>%
  filter(year == 2018,
         type != "Pumped hydro power") %>%
  select(-level) %>%
  pivot_wider(id_cols = c(country, country_name, year),
              names_from = type,
              values_from = energy) %>%
  mutate(Total_Renewable = Nuclear + Hydro + Wind + Solar + Geothermal + Other) %>%
  mutate(`Conventional thermal` = -`Conventional thermal`) %>%
  pivot_longer(cols = -c(country,country_name,year,Total_Renewable),
               names_to = "Energy Type",
               values_to = "value") %>%
  ggplot(aes(x = reorder(country_name,-Total_Renewable),
             y = value,
             fill = `Energy Type`)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90))
```


```{r average_production_plot }
average_production_plot <- energy_types %>%
  filter(type != "Pumped hydro power") %>%
  group_by(country_name,type) %>%
  summarise(average_energy = mean(energy)) %>%
  pivot_wider(id_cols = country_name,
              names_from = type,
              values_from = average_energy) %>%
  mutate(Total_Renewable = Nuclear + Hydro + Wind + Solar + Geothermal + Other) %>%
  mutate(`Conventional thermal` = -`Conventional thermal`) %>%
  pivot_longer(cols = -c(country_name,Total_Renewable),
               names_to = "Energy Type",
               values_to = "value") %>%
  ggplot(aes(x = reorder(country_name,-Total_Renewable),
             y = value,
             fill = `Energy Type`)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(title = "Average Renewable vs Non-Renewable Energy Production from 2016-2018",
       x = "",
       y = "Energy in GWh(Gigawatt hours)")

```
```{r average_production_plotly}
ggplotly(average_production_plot)
```


```{r yearly_production_plot}
yearly_production_plot <- energy_types %>%
  filter(level != "Level 2") %>%
  group_by(type,year) %>%
  summarise(total = sum(energy)) %>%
  pivot_wider(id_cols = year,
              names_from = type,
              values_from = total) %>%
  mutate(`Total Renewable` = Geothermal + Hydro + Nuclear + Other + Solar + Wind) %>%
  pivot_longer(cols = -year,
               names_to = "type",
               values_to = "total") %>%
  ggplot(aes(x = reorder(type,-total),
             y = total,
             fill = type)) +
  geom_col() +
  facet_wrap(~year) +
  theme(axis.text.x = element_text(angle = 90),
        axis.title.y = element_text(vjust=1)) +
  labs(title = "Total Energy Production by Type and Year",
       x = "",
       y = "Total energy production in GWh (Gigawatt hours)")

```



```{r yearly_production_plotly}
ggplotly(yearly_production_plot)
```


## How do energy imports vs exports compare between countries in Europe from 2016-2018?



```{r ,include=FALSE}
country_totals %>%
  filter(year == "2018") %>%
  select(country_name,type,energy) %>%
  pivot_wider(id_cols = country_name,
              names_from = type,
              values_from = energy) %>%
  mutate(Imports = -Imports) %>%
  select(country_name,Exports,Imports,`Total net production`) %>%
  mutate(net_import_export = Exports + Imports) %>%
  pivot_longer(cols = -c(country_name,`Total net production`, net_import_export),
               names_to = "Type",
               values_to = "Energy") %>%
  ggplot(aes(x = reorder(country_name,-net_import_export))) +
  geom_col(aes(y = Energy,
               fill = Type)) +
  geom_point(aes(y = net_import_export,
                 size = `Total net production`)) +
  theme(axis.text.x = element_text(angle = 90))
```

```{r export_import_plot}
export_import_plot <- country_totals %>%
  group_by(country_name,type) %>%
  summarise(average = mean(energy)) %>%
  pivot_wider(id_cols = country_name,
              names_from = type,
              values_from = average) %>%
  mutate(Imports = -Imports) %>%
  select(country_name,Exports,Imports,`Total net production`) %>%
  mutate(net_import_export = Exports + Imports) %>%
  pivot_longer(cols = -c(country_name,`Total net production`, net_import_export),
               names_to = "Type",
               values_to = "Energy") %>%
  ggplot(aes(x = reorder(country_name,-net_import_export))) +
  geom_col(aes(y = Energy,
               fill = Type)) +
  geom_point(aes(y = net_import_export,
                 size = `Total net production`)) +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(x = "",
       y = "Energy in GWh (Gigawatt hours)",
       title = "Average Export and Imports by Country 2016-2018")
```

```{r export_import_plotly}
ggplotly(export_import_plot)
```

```{r net_export_kable}
country_totals %>%
  replace_na(list(energy = 0)) %>%
  group_by(type,year) %>%
  summarise(total = sum(energy)) %>%
  pivot_wider(id_cols = year,
              names_from = type,
              values_from = total) %>%
  mutate(`Net export-imports` = Exports - Imports) %>%
  select(year, `Total net production`, `Energy supplied`, `Energy absorbed by pumping`, Exports, Imports, `Net export-imports`) %>%
  kable() %>%
  kable_styling()
```



## How the contributions of the sources to the production of electricity

[FILL] Should include at least one plot or numerical summary for each of your questions, that helps the reader arrive at an answer. You should also write paragraphs describing the methods, summaries and findings. 

# References
https://github.com/etc5521-2020/assignment-1-koala/blob/master/index.Rmd

https://svs.gsfc.nasa.gov/20114#:~:text=The%20'greenhouse%20effect'%20is%20the,radiating%20from%20Earth%20toward%20space.&text=The%20gases%20that%20contribute%20to,%2C%20and%20chlorofluorocarbons%20(CFCs).

https://www.peninsulacleanenergy.com/faq-items/what-is-the-difference-between-clean-and-renewable-energy/

https://ember-climate.org/wp-content/uploads/2018/01/EU-power-sector-report-2017.pdf


https://ourworldindata.org/energy

